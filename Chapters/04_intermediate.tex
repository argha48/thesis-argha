\chapter{Projecting Long Range Non-Diffracting Waves}
\label{ch:intermediate}

\section{Tractor Beam: A Special Case of  Non-Diffracting Waves}

The term ``Tractor beam'' was coined in 1931 by Dr. Edward Smith, a chemist moonlighting as a science fiction author [ADD REFERENCE]. The term was popularized into a science fiction by writers of ``Star Trek'' in the 1960's. In all of those imagined realizations, a tractor beam is projected by a space ship to capture and transport distant objects back to the ship. 
Ashkin and his coworkers \cite{block1992} appropriated the term in referring to their discovery of optical tweezers. Unlike their sci-fi counterparts, however, optical tweezers only pull objects upstream over a limited range, typically less than one micrometer. Beyond this range, radiation dominates the intensity gradient trapping force and blows illuminated objects downstream. True tractor beams are a class of traveling waves that transport objects back to its source, opposite to the direction of propagation ideally along the entire length. Following Eq.~\eqref{eq:Electric Lorentz force} the force field of a mode of light needs to satisfy the condition:
\begin{equation}
\label{eq:Tractor Fz condition}
\vec{F}_{z}\cdot \vec{\hat{z}} <0
\end{equation}
to be considered a tractor beam. In $2005 $ \v Ci\v zm\'ar \emph{et al.} \cite{cizmar2005} described optical conveyor belt which can transport micrometer scale objects bidirectionally over a distance of $\SI{250}{\um}$. Even though it has a long range of transport, this mode of light ``is based on a standing wave (SW) created from two counter-propagating nondiffracting beams where the phase of one of the beams can be changed'' \cite{cizmar2005}. Because the conveyor belt is not a travelling wave it is not a tractor beam by our definition. One sided tractor beams were experimentally demonstrated by Ruffner and Grier \cite{ruffner2012prl} in both cases by coherently superposing coaxial Bessel beams.

Because Bessel functions form a complete set of orthogonal basis functions which are solutions to the paraxial Helmholtz equation, any propagation-invariant or linear non-diffracting mode of light can be expressed as a linear superposition \cite{Ruffner:14, Lee:10, ruffner2012prl} of Bessel beams. In the force calculation for a single Bessel beam using Eq.~\eqref{eq:Electric Lorentz force} it is evident that the $\vec{z}$-component of $\vec{F_e}(\vec{r})$ satisfies the propagation invariance because
\begin{equation}
\label{eq:Single Bessel gradient force}
\partial _{z} \sum ^{j=2}_{j=0} u_{j}^2(\vec{r}) = 0 \quad .
\end{equation}
Conventional materials radiate light even if they do not otherwise absorb it and so have $\alpha _{e}^{\prime \prime} > 0$. This means that the second term in Eq.~\eqref{eq:Electric Lorentz force},
\begin{equation}
\label{eq:Single Bessel 2nd term}
\alpha _{e}^{\prime\prime}\sum ^{2}_{j=0} u_{j}^2(\vec{r}) \partial _{z}\phi _{j}(\vec{r}) >0
\end{equation}
is non-negative. On this basis we conclude that a single Bessel beam cannot act as a tractor beam for small particles at least not at the dipole order. Even so, it is possible to construct a superposition Bessel beams which can act as a long range propagation-invariant tractor beam. The simplest such superposition consists of two Bessel beams
\begin{equation}
\label{eq:two bessel superposition E}
E(\vec{r}, \theta) = a_{1} E_{\alpha, m}(\vec{r},\theta) + a_{2} E_{\alpha ^{\prime},m^{\prime}}(\vec{r},\theta) \quad ,
\end{equation}
where the amplitudes $a_1$ and $a_2$, convergence angles $\alpha$ and $\alpha ^{\prime}$, and winding numbers $m$ and $m^{\prime}$ determine the structure and capabilities of the superposition. Because each of the component Bessel beams is propagation invariant, the superposition is as well. We will focus on two classes of two-component superposition to illustrate how two  waves can create a tractor beam.


\subsection{Conveyor Beam}
Following Eq.~\eqref{eq:two bessel superposition E}, an optical conveyor beam is a superposition of two $0$th order Bessel beams, $m=m^{\prime} = 0$. In this case the component Bessel beams differ only in that convergence angles, $\alpha$ and $\alpha ^{\prime}$. They then interfere to create a periodic amplitude profile along the axis of symmetry. If $a_1 = a_2 = 1$, the electric field along the axis ($\vec{r}=0$) is maximally modulated. The associated intensity profile
\begin{equation}
\label{eq:conveyor electric field axis}
\vert E(z) \vert ^2 = 4 \cos ^2 \left( kz\frac{\cos \alpha - \cos \alpha ^{\prime}}{2}\right) \exp ^2 \left( ikz \frac{\cos \alpha + \cos \alpha ^{\prime}}{2}\right) \quad ,
\end{equation}
has alternating maxima and minima separated by:
\begin{equation}
\label{eq:conveyor period}
\delta z = \frac{2\pi}{k \left( \cos \alpha - \cos \alpha ^{\prime}\right)} \quad .
\end{equation}
Particles can be trapped in each on the array of intensity maxima and and transported upstream or downstream along the axis of the conveyor beam by selectively altering the relative phase of the interfering Bessel beams. The axial transport velocity of the trapped particle depends on the rate of change in the relative phase of the two Bessel beams, which can be written as:
\begin{equation}
\label{eq:conveyor velocity}
v(t) = \frac{\delta z}{2\pi}\frac{\partial \phi (t)}{\partial t} \quad ,
\end{equation}
where $\phi (t)$ is the time dependent change in phase difference between the two interfering Bessel beams. A detailed force calculation was reported in \cite{ruffner2012prl} and it suggests conveyor beam can act as a tractor beam irrespective of a particle's characteristics. While particles with refractive index relative to the medium greater than one will be trapped in the intensity maximum, dark-seeking i.e. particles whose relative refractive index is less than one, will find the local intensity minimum as the stable point.


\subsection{Solenoidal Beam}
Most common laser modes are bright along the axis and so broadly resemble cylinder. A solenoid beam by contrast has an  intensity maximum that spirals around the axis of propagation. Solenoid beams are similar to optical conveyor in that they are solutions of the Helmholtz equation in the paraxial limit and  can be expanded as a superposition of Bessel beams. The first experimentally realized solenoid beam, presented in \cite{Lee:10} involved a fairly complex superposition:
\begin{equation}
\label{eq:lee solenoid bessel sum}
\vec{E}_{\gamma, l}(\vec{r},z) = \sum ^{[l]}_{m=[l-\gamma k]}\frac{l-m}{\gamma ^2}J_{m}(q_m R)e^{i\frac{l-m}{\gamma}z}e^{im\theta}J_{m}(q_m r) \quad ,
\end{equation}
where $\gamma$ is the pitch of the spiral intensity profile and $R$ is the radius. [XXXXXXX ADD FIG FROM LEE PAPER]
The spiraling intensity profile of a solenoid beam is discreetly propagation invariant mode of light along its axis of propagation, which can be written as:
\begin{equation}
\label{eq:discreet propagation invariant}
I\left(\vec{r},\theta, z\right) = I\left(\vec{r},\theta, z+\vartriangle z\right) \quad ,
\end{equation}
but the radial intensity profile remains unchanged in the spiraling frame of reference \cite{Tervo01}. Figure.~\ref{fig:solenoid wavefronts} shows how the wavefronts update with changing helical pitch $l$ from Eq.~\eqref{eq:lee solenoid bessel sum}. For $l<0$ (e.g.~Fig.~\ref{fig:solenoid wavefronts}(c) where $l=-40$) the phase gradient force acts as a pulling force which moves trapped objects upstream.
\begin{figure}[t!]
  \centering
  \includegraphics[width=0.8\textwidth]{lee2010opex}
  \caption{Retrograde forces in a helical solenoid beam. The local wave vector k is normal to the light's wavefronts, with a component in the $\hat{z}$ direction. (a) $l = +40$: $\vec{k}$ is directed along the solenoid, resulting in a downstream phase-gradient force. (b) $l = 0$: Wavefronts are parallel to the solenoid so that k is everywhere normal to the spiral. Particles trapped by intensity-gradient forces experience no net force. (c) $l = -40$: A component of $\vec{k}$ is directed back down the spiral. A particle confined to the spiral therefore moves upstream. Source: Reprinted with permission from \cite{Lee:10}.}
  \label{fig:solenoid wavefronts}
\end{figure}


A far simple superposition of two coherent Bessel beams also generate a solenoidal beam. The condition  for spiraling interference is met when
\begin{equation}
\label{eq:solenoid superposition bessel phase}
\left( m\theta + k\cos \alpha z \right) -\left(m^{\prime}\theta + k\cos \alpha ^{\prime} z \right) = 2n\pi \quad ,
\end{equation}
where $n$ is a non-negative integer. The intensity maximum traces a spiral path that can be described in the cylindrical coordinates as a function of axis of propagation $z$ as:
\begin{equation}
\label{eq:screw function}
\theta _{0}(z) = \frac{kz\left( \cos \alpha - \cos \alpha ^{\prime}\right)}{m-m^{\prime}} .
\end{equation}
By changing the topological charges ($m$,$m^{\prime}$) or the angle of convergence ($\alpha$,$\alpha ^{\prime}$) of individual Bessel beams, we can control pitch the ($\gamma$) and radius of the  solenoid's intensity maximum. For  example, if we wish to create a solenoid beam with intensity maximum at $r=R$ which is formed for to superposition of  the $\nu$-th maximum of $J_m$ and the $\nu ^{\prime}$-th maximum of $J_{m^{\prime}}$ we need to ensure that
\begin{equation}
\label{eq:bessel maximum match condition}
\frac{\sin \alpha}{j^{\prime}_{m,\nu}} 
		= \frac{\sin \alpha ^{\prime}}{j^{\prime}_{m^{\prime},\nu ^{\prime}}} 
		= \frac{1}{kR} \quad ,
\end{equation}
where $x=j^{\prime}_{m,\nu}$ is the $\nu$-th root of $J^{\prime}_{m}\left( x\right)=0$. In this case, the value of $\gamma$ is:
\begin{equation}
\label{eq:simple solenoid pitch}
\gamma = \frac{2\pi}{k}\frac{m-m^{\prime}}{\cos \alpha - \cos \alpha ^{\prime}}
\end{equation}
and there are $|m-m^{\prime}|$ maxima in the transverse intensity profile. Modifying either the numerator or the denominator in Eq.~\eqref{eq:simple solenoid pitch} to change the overall sign of $\gamma$ will change the chirality of the helical solenoid beam. The intensity maximum at $r=R$ generates an intensity-gradient force that pulls objects towards the spiral which therefore acts as an extended optical trap. Phase gradients propel trapped particles in the axial direction. For the special case
\begin{equation}
\label{eq:solenoid tractor condition}
m^{\prime}\cos \alpha > m \cos \alpha ^{\prime} \quad ,
\end{equation}
the solenoid beam acts as a tractor beam. This also makes $\nu^{\prime} > \nu$ a necessary condition for the superposition to exert a retrograde force. Conditions from Eq.~\eqref{eq:bessel maximum match condition} and Eq.~\eqref{eq:solenoid tractor condition} combined to obtain the overall condition
\begin{equation}
\label{eq:convergence angle limit}
\sin ^{2} \alpha < \frac{\left(\frac{m^2}{m^{\prime ^{2}}}-1\right)}{\left(\frac{m^2}{m^{\prime ^{2}}} - \frac{j_{m,\nu}^{\prime ^{2}}}{j^{\prime ^{2}}_{m^{\prime},\nu ^{\prime}}}\right)}
\end{equation}
 for the beam of light to act as a tractor beam. This previously unpublished result defines the class of dipole-order tractor beams that can be constructed from superposition if pairs of Bessel beam.


\subsection{Strongly Localized Solenoidal Beam}

The two component solenoid is conceptually simple, but not optimal for transporting objects. More sophisticated superposition of Bessel beam can embrace the intensity and phase gradient required for tractor beam operation. Ideally the  electric field in a solenoidal tractor beam would have the form:
\begin{equation}\label{eq:Green spiral}
G(\mathbf{r}, z) = \delta (r-R)\delta (\theta - \theta_{0}(z)) e^{i\phi (\mathbf{r}, z)} \quad ,
\end{equation}
where $\theta_{0}(z) = \frac{z}{\gamma}$. Here $\gamma$ will define the pitch of the spiral. We also seek the Green's function to be of the form:
\begin{equation}\label{eq:Green w Bessel}
G(\mathbf{r}, z) = \Sigma _{n=0}^{\infty}a_n \psi _{n}(\mathbf{r},z) \quad ,
\end{equation}
where $\psi_{n} (\mathbf{r}, z)$ are given by:
\begin{equation}\label{Eq: Bessel fn}
\psi_{n}(\mathbf{r}, z) = A_{n}J_{n}(k_{n}r \cos\alpha _n)e^{in\theta}e^{ik_{n}z\cos\alpha _n} \quad ,
\end{equation}
where $A_n$ is a normalization constant. Combining Eq.~\eqref{eq:Green spiral} and Eq.~\eqref{eq:Green w Bessel} we obtain the coefficients $a_n$ in Eq.\ref{Eq: Green w Bessel}. 
\begin{equation}\label{Eq: Green coeff}
a_{n} = \frac{1}{A_n}R J_{n}(k_n R \sin\alpha _n)e^{-i k_n z \cos\alpha _n}e^{-in\frac{z}{\gamma}}e^{i\phi(R,z)} \quad .
\end{equation}
We want the coefficients $a_n$ to be independent of $z$. Therefore,
\begin{equation}\label{Eq: phi reln.}
\phi(R,z) = k_nz\cos\alpha _n + n\frac{z}{\gamma} \quad .
\end{equation}
So the final Green's function is given by:
\begin{equation}\label{Eq: Green final}
G(\textbf{r},z) = \Sigma _{n=0}^{\infty} J_n(k_n R \sin\alpha _n)J_{n}(k_n r \sin\alpha _n) e^{in\theta}e^{ik_n z\cos\alpha _n}
\end{equation}

Choosing, $k_i = k_j = k = \frac{2 \pi}{\lambda}$ and $\phi (R,z) = \phi _0 z$ we obtain 
\begin{equation}\label{Eq: cos alpha}
\cos\alpha _n = \frac{1}{k}(\phi _0 - \frac{n}{\gamma}) \quad .
\end{equation}
This expression meets the same design criteria that was seen in \cite{lee10} but has the benefit of faster convergence and thus better performance in practice.

\section{Projecting Bessel Beam with \\ Digital Hologram}
\label{sec:Project Bessel Hologram}

Holograms intended for optical micromanipulation typically are designed to modify the phase profile of an incident laser beam, but not the amplitude. The phase-only hologram then propagates to a converging lens that transforms it into the intended mode. Scalar diffraction theory approximates this transformation as a Fourier transform \cite{goodman05} as described in described in Sec.~\ref{sec:HOT} and Sec.~\ref{sec:PhaseHOT}. Difficulties are encountered when the Fourier transform of the desired mode features amplitude variations that can not be encoded naturally in a phase-only diffractive optical element.

For example, the ideal complex-valued hologram encoding 
an $m$-th order Bessel beam takes the form of an infinitesimally fine ring,
\begin{equation}
  \label{eq:besselhologram}
  E_{\alpha,m}(\vec{r},0)
  =
  \delta(r - R_\alpha) \, e^{i m\theta},
\end{equation}
whose radius, 
\begin{equation}
\label{eq:Ralpha}
R_{\alpha} = f \, \tan \alpha \quad ,
\end{equation}
depends on the focal length of the projecting lens, $f$, and the desired convergence angle of the Bessel beam, $\alpha$. 
Equation~\eqref{eq:besselhologram} expresses the
scalar field in terms of the two-dimensional
polar coordinates, $\vec{r} = (r,\theta)$, in the plane $z = 0$.
More generally, $E_{\alpha,m}(\vec{r},z)$ describes the
transverse profile of the same field at axial position $z$.

The ideal ring hologram consists of an amplitude mask, shown
schematically in
\begin{figure}[t!]
  \centering
  \includegraphics[width=0.6\textwidth]{phase_only_schema}
  \caption{Conventional
    holographic projection of a Bessel beam.  The field diffracted
    by a ring hologram propagates to a converging lens of
    focal length $f$ that projects it into the non-diffracting mode.}
  \label{fig:phase_only_schema}
\end{figure}
Fig.~\ref{fig:phase_only_schema},
that only allows light to pass through the thin annulus at radius
$R_\alpha$, and a phase mask that imposes a helical pitch on the
transmitted wavefronts.
The same effect can be achieved with a
phase-only hologram,
\begin{equation}
  \label{eq:idealbesselhologram}
  \varphi_{\alpha,m}(\vec{r})
  =
  \begin{cases}
    m \theta \bmod 2 \pi, & r = R_\alpha \\
    \varphi_0(\vec{r}), & \text{otherwise}
  \end{cases}
\end{equation}
where $\varphi_0(\vec{r})$ is an unspecified
phase function that diverts light away from the
axis \cite{roichman06}.

Equation~\eqref{eq:idealbesselhologram}
poses two substantial problems for standard
holographic trapping implementations
of the kind represented in Fig.~\ref{fig:phase_only_schema}.
In the first place, the delta-function
amplitude profile in the hologram plane cannot be encoded
faithfully on a pixelated diffractive optical element.
The bright ring in Fig.~\ref{fig:phase_only_schema} represents
the intensity,
$I(\vec{r},0) = \left\vert  E_{\alpha,0}(\vec{r},0)\right\vert^2$,
projected by an $m = 0$ ring hologram, treated as an
ideal amplitude mask.
The ring's finite thickness arises from the mask's
finite pixel size.
Rather than projecting a wave with a single value of $\alpha$,
this finite-thickness ring constitutes a superposition of
ring holograms that corresponds to a
superposition of Bessel beams with
a range of convergence angles.
Interference among these superposed modes
causes periodic axial intensity variations,
and so limits the propagation-invariant
range of the superposition \cite{ruffner12a} as shown in Fig.~\ref{fig:previous bessel hologram}(b). Figure.~\ref{fig:previous bessel hologram}(d) shows a conveyor beam created by using a digital hologram that encodes two Bessel beam as a ring with certain thickness. Using this method constrain the propagation-invariant range to the order of \SI{100}{\um}

\begin{figure}[t!]
  \centering
  \includegraphics[width=0.8\textwidth]{ruffner2012prl}
  \caption{(a) Schematic representation of holographic projection of a Bessel beam with axial wavenumber $\alpha k$ by a lens of focal length $f$. Shaded region indicates volume of invariant propagation. (b) Volumetric reconstruction of a holographically projected Bessel beam. (c) Phase hologram encoding an optical conveyor. Diagonal blazing tilts the projected conveyor away from the optical axis. (d) Volumetric reconstruction of the beam projected by the hologram in (c). The color bar indicates relative intensities in (b) and (d). Source: Reprinted with permission from \cite{ruffner12a}.}
  \label{fig:previous bessel hologram}
\end{figure}


In the second place, only a few pixels in
the hologram plane contribute to the intended Bessel beam.
The rest of the hologram's area is dedicated to the
phase function $\varphi_0(\vec{r})$ that diverts
extraneous light away from the desired mode.
Pixelated ring holograms thus suffer from a combination of
poor mode fidelity and extremely poor diffraction efficiency.






\section{Intermediate Plane Holography}

%Structuring laser beams with computer-generated holograms
%has created revolutionary opportunities for
%optical micromanipulation \cite{grier03} and
%optical communication \cite{gibson04,bozinovic13,willner15}.
%Using holograms to project propagation-invariant modes of light,
%for example, has led to the remarkable
%discovery that some non-diffracting modes
%can act as tractor beams, pulling illuminated objects
%upstream rather than trapping them or pushing them downstream
%\cite{marston06,lee10}.
%Applications of tractor beams and other exotic light modes have
%been hampered by the poor diffraction efficiency of the
%holograms used to project them, which can be less
%than \num{e-3} \cite{ruffner12a,ruffner14}.

To address these problem, we introduce intermediate-plane
holography, which can dramatically improve
both diffraction efficiency and mode purity.
We illustrate these capabilities by projecting
Bessel beams, which constitute 
the natural basis for propagation-invariant modes \cite{durnin87,durnin87a}.
We then use these techniques to project meter-long
optical conveyors \cite{cizmar05,ruffner12a,ruffner14}
and solenoid beams \cite{lee10,yevick16}, 
which are tractor-beam modes composed of superpositions of Bessel
beams.
These experiments demonstrate a \num{400}-fold improvement in 
diffraction efficiency relative to the standard holographic optical
trapping technique, and a
\num{100}-fold increase in non-diffracting range.


\begin{subequations}
\label{eq:intermediatebesselhologram}
Both deficiencies mentioned in Sec.~\ref{sec:Project Bessel Hologram} can be mitigated by considering
light's propagation from the hologram plane to the converging
lens.  The field at distance
$z$ along the optical axis may be estimated with the
Rayleigh-Sommerfeld diffraction integral \cite{born99},
\begin{equation}
  \label{eq:rayleighsommerfeld}
  E(\vec{r},z)
  =
  \int \tilde{E}(\vec{q},0) \tilde{H}_z(\vec{q}) e^{- i \vec{q} \cdot \vec{r}} \,
  d^2q ,
\end{equation}
where $\tilde{E}(\vec{q},0)$
is the Fourier transform of the field
$E(\vec{r},0)$ in the plane $z = 0$
and
\begin{equation}
  \label{eq:propagator}
  \tilde{H}_z(\vec{q}) 
  =
  e^{i z \sqrt{k^2 - q^2}}
\end{equation}
is the Fourier transform of the Rayleigh-Sommerfeld propagator
for light of wave number $k$ \cite{goodman05}.
\end{subequations}
Because the light diffracts as it propagates,
challenging amplitude variations in $E(\vec{r},0)$
can be substantially less pronounced in the intermediate plane
at axial position $z$.
This can be seen in the intermediate-plane intensity,
$I(\vec{r},z) = \left\vert E_{\alpha,0}(\vec{r},z) \right\vert^2$,
for the $m = 0$ mode in 
\begin{figure}[t!]
  \centering
  \includegraphics[width=0.8\textwidth]{Evol}
  \caption{The electric field intensity distribution becomes smoother as we move from $z=0$ to an intermediate plane. This figure shows a volumetric reconstruction of the electric field intensity computed using Rayleigh-Sommerfeld propagator.}
  \label{fig:Evol of Bessel beam}
\end{figure}
Fig.~\ref{fig:Evol of Bessel beam}.
A phase-only hologram designed for this plane therefore will have
much better diffraction efficiency than the ideal
hologram designed for $z = 0$.
Indeed, the location, $z$, of the intermediate plane
can be selected to maximize this benefit.
Improving diffraction efficiency naturally improves
mode fidelity by reducing the amount of light in
unwanted modes.
Performance may be even better than this observation
suggests because $E(\vec{r},z)$ is
computed from the ideal field, without compromise
for pixelation.

The phase-only intermediate-plane hologram associated with
$E(\vec{r},0)$ may be approximated by the phase, $\varphi(\vec{r},z)$,
of $E(\vec{r},z)$, ignoring amplitude variations.
The intermediate-plane phase for the $m = 0$ Bessel beam
is presented in Fig.~\ref{fig:intermediate}(b).
If necessary, some accommodation may be made for remaining
amplitude variations through any of the techniques
that have been developed for encoding complex-valued
fields on phase-only diffractive optical elements \cite{roichman06}.
In practice, this often is unnecessary, and the phase of the
computed intermediate-plane field serves as a
mode-forming hologram with high diffraction efficiency.

The benefits of intermediate-plane holography come at
a cost.  Specifically, the diffractive optical element no
longer is located in the focal plane of the projecting
lens.  This requires modifying the optical layout of a typical
holographic trapping system.
For the particular case of reflective holograms,
space constraints may limit the range of $z$,
and thus the benefit of the technique.
In cases where large positive values of $z$ are 
physically inaccessible,
negative values may offer the same benefits while
affording sufficient space for practical implementation.

\begin{figure}[t!]
  \centering
  \includegraphics[width=\textwidth]{intermediate4smnew}
  \caption{Intermediate-plane holography. 
    (a) A phase-only hologram
    in an intermediate plane recreates the ring-hologram's
    wavefront structure at substantially higher diffraction efficiency.
    (b) Moving the intermediate plane to $z = f$ and incorporating
    the phase function for the converging lens
    creates a mode converter that projects the Bessel beam directly.
    Intermediate-plane phase holograms for
    (c) an optical conveyor and (d) a solenoid beam.  The beams
    projected by these holograms are shown in Fig.~\ref{fig:tractorbeams}.}
  \label{fig:intermediate}
\end{figure}

Setting $z = f$ addresses these geometric considerations
by placing the intermediate-plane hologram
in the same plane as the converging lens.
The associated parabolic phase profile,
\begin{equation}
  \label{eq:lensphase}
  \varphi_f(\vec{r}) = \frac{\pi r^2}{\lambda f}
  \bmod 2 \pi,
\end{equation}
can be integrated into the phase function
for the intermediate-plane hologram, 
\begin{equation}
  \label{eq:complete}
  \varphi(\vec{r}) 
  =
  \left[\varphi(\vec{r},f) +
  \varphi_f(\vec{r}) \right]
  \bmod 2 \pi, 
\end{equation}
thereby eliminating the need for
the physical lens altogether.
This mode of operation is presented in
Fig.~\ref{fig:intermediate}(b) and is the
approach we will adopt for experimental demonstrations.

For the particular case of a Bessel beam,
the Fourier transform of the ideal ring hologram is
\begin{equation}
  \tilde{E}_{\alpha,m}(\vec{q},0)
  =
  J_m(qR_\alpha) \, e^{i m \theta}.
\end{equation}
Applying Eq.~\eqref{eq:intermediatebesselhologram}
then yields an expression for the field in the 
intermediate plane,
\begin{equation}
  \label{eq:radialintegral}
  E_{\alpha,m}(\vec{r},z)
  =
  e^{i m \theta}
  \int_0^k 
  q 
  J_m(q r) 
  J_m(qR_\alpha) \, 
  e^{i z \sqrt{k^2 - q^2}} dq ,
\end{equation}
whose phase is the first-order approximation to the
intermediate-plane phase hologram encoding the Bessel beam.
The upper limit of integration in Eq.~\eqref{eq:radialintegral}
ignores exponentially small contributions from terms with
$q > k$ because $kz \gg 1$ in practice. 

The integral in Eq.~\eqref{eq:radialintegral} appears not to have a known solution in closed form. We therefore adopt the same approximation scheme use in dividing the Rayleigh Sommerfeld propagator.
The idea is to retain as much information
as possible while reducing the rate of amplitude modulation so that the second term 
in Eq.~\eqref{eq:extrafield} is small or negligible.

\begin{figure}[t!]
  \centering
  \includegraphics[width=\textwidth]{intermediate4sm}
  \caption{[MAKE THE RIGHT IMAGE XXXXXXX] Schematic Intermediate-plane field calculation.}
  \label{fig:intermediate field schema}
\end{figure}
Following the schematic in Fig.~\ref{fig:intermediate field schema}, 
the electric field at axial position $z$ will be
\begin{equation}
\label{eq:intermediate field a}
U(x,y,z) = \frac{i}{\lambda}\int _{x^{\prime},y^{\prime}}U(x^{\prime},y^{\prime},0)
					\cos \phi ^{\prime} \frac{\exp 
					\left( ik\ell \right)}{\ell}dx^{\prime}dy^{\prime} \quad .
\end{equation}
$\cos\phi ^{\prime}$ can be written in terms of $z$ and $\ell$ as 
\begin{equation}
\cos \phi ^{\prime} = \frac{z}{\ell}
\end{equation}
which yields,
\begin{equation}
\label{eq:intermediate field b}
U(x,y,z) = \frac{i}{\lambda}\int _{x^{\prime},y^{\prime}}U(x^{\prime},y^{\prime},0)
					\frac{z}{\ell ^2} \exp 
					\left( ik\ell \right)dx^{\prime}dy^{\prime} \quad .
\end{equation}
In Cartesian coordinate, $\ell$ can be written as:
\begin{equation}
\label{eq:ell in cartesian}
\ell ^2 = (x-x^{\prime})^{2} + (y-y^{\prime})^{2} + z^{2} \quad ,
\end{equation}
and $\rho = x^2 + y^2 + z^2$. We can rewrite $\ell$ from 
Eq.~\eqref{eq:ell in cartesian} in terms of $\rho$ as 
\begin{equation}
\label{eq:ell in r}
l = \rho - \frac{xx^{\prime}+yy^{\prime}}{\rho} + \frac{x^{\prime^{2}} + y^{\prime^{2}}}{2\rho}
			+ \mathcal{O}\lbrace \frac{x^2x^{\prime ^{2}}}{\rho ^3},\frac{y^2y^{\prime ^{2}}}{\rho ^3} \rbrace
\end{equation}
Moving to polar coordinates from Cartesian coordinates such that
\begin{subequations}
\begin{equation}
\left( x^{\prime},y^{\prime}\right) \longrightarrow \left( \eta , \phi \right) \quad ,
\end{equation}
\begin{equation}
 \left( x,y\right) \longrightarrow \left(r , \theta \right) \quad ,
\end{equation}
\end{subequations}
we can rewrite Eq.~\eqref{eq:intermediate field b} as
\begin{equation}
\label{eq:intermediate field c}
U(r ,\theta) = \frac{i}{\lambda} \frac{z}{\rho ^2}\int U(\eta ,\phi)\exp \left[ -\frac{ik}{\rho}\left( r \eta \cos (\theta - \phi) - \eta ^2 \right)\right]d^2\eta
\end{equation}
To produce a Bessel beam in the $(r,\theta)$ plane we need 
\begin{equation}
\label{eq:delta field}
U(\eta , \phi) = \delta (\eta - R_{\alpha}) \quad ,
\end{equation}
where $R_{\alpha}$ is the radius of the infinitesimal ring similar to what is mentioned in Eq.~\eqref{eq:besselhologram}. Replacing $U(\eta ,\phi)$ with Eq.~\eqref{eq:delta field} in Eq.~\eqref{eq:intermediate field c} yields:
\begin{equation}
\label{eq:intermediate field d}
U(r ,\theta) = \frac{i}{\lambda} \frac{R_{\alpha}z}{\rho ^2}  \exp 
						\left[ i\left( k\rho + \frac{k}{\rho}R_{\alpha}^2\right)\right]
						\int _{0}^{2\pi}  e^{-i\frac{k}{\rho}R_{\alpha}r\cos (\theta - \phi)} d\theta \quad .
\end{equation}

Equation~\eqref{eq:intermediate field d} can be computed
analytically for arbitrary $\alpha$ and $m$.  
In the limit $z > R_\alpha$, it reduces to
\begin{subequations}
  \label{eq:intermediatehologram}
\begin{equation}
  E_{\alpha,m}(\vec{r}, z)
  \approx
  \beta^2 \,
  e^{-i \frac{k r^2}{2 z}} \, 
  e^{i k R_\alpha \left(\beta + \frac{1}{\beta}\right)} \,
  J_m\left( \beta \, kr \right) \, e^{i m \theta} ,
\end{equation}
where
\begin{figure}[t!]
  \centering
  \includegraphics[width=0.8\textwidth]{lensphase}
  \caption{The figure shows how the phase changes as we change the depth of the intermediate plane for projecting the hologram. At $z\gg R_{\alpha}$ the phase reduces to the phase profile of an axicon, which is the physical way to create a Bessel beam from a collimated beam of coherent light.}
  \label{fig:axicon phase}
\end{figure}

\begin{equation}
  \beta
  =
    \frac{R_\alpha}{\sqrt{r^2 + z^2}}.
  \end{equation}
\end{subequations}
The single-element mode converter,
\begin{equation}
  \label{eq:besselfield}
  E_{\alpha,m}(\vec{r}) 
  =
  E_{\alpha,m}(\vec{r},f) \, e^{i \varphi_f(\vec{r})},
\end{equation}
has a phase profile that, in turn, reduces to the
conical profile of an axicon as shown in Fig.~\ref{fig:axicon phase} 
in the long-range
limit, $z \gg R_\alpha$.


An axicon's departure from the profile
in Eq.~\eqref{eq:intermediatehologram}
can reduce the mode purity and non-diffracting
range of the beams it projects.
Physical axicons have the further problem that
their tips cannot be infinitely sharp.
Rounding introduces mode artifacts that also reduce the 
propagation-invariant range \cite{brzobohaty08}.

Another point to consider while choosing the optimum $z$
is the rate of change of phase in the $(r,\theta)$ plane. For a 
constant $r=R_0$ the maximum phase 
$\varphi _{\mathrm{max}}$ scales as $\frac{1}{z^2}$, which
limits the ability to encode a phase in a phase only SLM 
with finite sized pixels.

\begin{figure}[t!]
  \centering
  \includegraphics[width=0.8\textwidth]{bsqfit.png}
  \caption{Higher order Bessel beams $J_{5}$,
 $ J_{15}$,$ J_{25}$, and $J_{35}$ are created using 
  intermediate plane holography for 
  $z=\SI{54 }{\um}$. The black solid line is 
  the best non-linear fit of the intensity distribution of
  the Bessel beams. Perfect overlap of experimental and 
  analytical solution suggests high mode purity of the
  generated modes of light.}
  \label{fig:bessel quality}
\end{figure}

Figure.~\ref{fig:bessel quality} shows higher order Bessel
beams created with a phase hologram computed from the 
intermediate plane electric field at $z=\SI{54}{\um}$.
The mode purity decreases as $m$ increases.


\section{Volumetric Imaging}

Figure~\ref{fig:tractorbeams}(a) shows a volumetric
rendering of a Bessel beam with $m = 0$ and
$\alpha = \SI{3.9}{\milli\radian}$ created with
Eq.~\eqref{eq:intermediatehologram}.
This linearly polarized beam was created at $\lambda = \SI{532}{\nm}$
(Coherent Verdi 5W)
using a phase-only spatial light modulator (SLM, Hamamatsu X10468-16)
to imprint the phase of the field described by
Eq.~\eqref{eq:intermediatehologram}
on the collimated beam's wavefronts.
The beam's intensity profile was measured by
moving a standard
video camera (NEC TI-324AII) along an optical rail in \SI{2.5}{\mm}
increments over a range of one meter.
Each transverse slice has a transverse spatial resolution of \SI{8.64}{\um}.
The transverse width of these beam's intensity maxima does not change
appreciably over at least twice the plotted range.
%Figure~\ref{fig:tractorbeams}
%is limited to a range of one meter for clarity.

\begin{figure*}[!t]
  \centering
  \includegraphics[width=0.9\textwidth]{collimated}
  \caption{Propagation-invariant modes projected with intermediate-plane
    holograms.  (a) Bessel beam, $m = 0$, $\alpha = \SI{3.9}{\milli\radian}$.
    (b) Optical conveyor,
    $m = 0$,
    $\alpha_1 = \SI{3.9}{\milli\radian}$,
    $\alpha_2 = \SI{8.8}{\milli\radian}$.
    (c) Solenoidal tractor beam,
    $m_1 = \num{-10}$,
    $m_2 = \num{-7}$,
    $\alpha_1 = \SI{6.4}{\milli\radian}$,
    $\alpha_2 = \SI{8.8}{\milli\radian}$.}
  \label{fig:tractorbeams}
\end{figure*}

Superpositions of Bessel beams can be obtained
by superposing results of the form predicted
by Eq.~\eqref{eq:besselfield} \cite{mcgloin03b}.
These are particularly useful for projecting
tractor beams.
The field for an optical conveyor
\cite{cizmar05,ruffner12a,ruffner14},
for example, can be as simple as a two-fold superposition
of equal-helicity Bessel beams:
\begin{equation}
  \label{eq:conveyorfield}
  E_{\alpha,m}^{\delta \alpha}(\vec{r},\phi)
  =
  E_{\alpha,m}(\vec{r})
  +
  e^{i \phi} \,
  E_{\alpha+\delta\alpha,m}(\vec{r}).
\end{equation}
An example with $m = 0$, $\alpha = \SI{3.9}{\milli\radian}$
and $\delta \alpha = \SI{4.9}{\milli\radian}$
is presented in Fig.~\ref{fig:intermediate}(c) and Fig.~\ref{fig:tractorbeams}(b).
This beam's axial intensity profile is characterized by
a periodic array of maxima spaced by
$\Delta z = \lambda [\tan (\alpha + \delta\alpha) - \tan
\alpha]^{-1}$.
The alternating intensity maxima and minima act as
traps for illuminated objects that can be moved
along the axis by
varying the relative phase, $\phi$
\cite{cizmar05,ruffner12a,ruffner14}.

Images were recorded with a total beam power of \SI{1}{\milli\watt},
as recorded by an optical power meter (Coherent Lasermate).
The upper limit of the conveyor beam's power, \SI{1}{\watt}, was
set by the \SI{3}{\watt} limit of the SLM, with a total diffraction
efficiency of \num{0.3} into the desired mode.
This represents a factor of \num{400} improvement of diffraction
efficiency relative to a standard ring hologram
\cite{ruffner12a,ruffner14}
given the SLM's \num{800 x 600} array of phase pixels.
The beam's non-diffracting range exceeds that of previously
reported holographically-projected conveyor modes
\cite{ruffner12a,ruffner14}
by a factor of more than \num{e3}.

Intermediate-plane holography is particularly useful for projecting
more sophisticated superpositions of Bessel beams, such
as the solenoidal wave presented in Fig.~\ref{fig:intermediate}(d) and
Fig.~\ref{fig:tractorbeams}(c).
This two-beam superposition has the general form
\begin{equation}
  \label{eq:solenoid}
  E_{\alpha,m}^{\mu}(\vec{r})
  =
  E_{\alpha,m}(\vec{r})
  +
  \frac{J_m(j'_{m,2})}{J_{m'}(j'_{m',1})}
  E_{\alpha',m'}(\vec{r}),
\end{equation}
where $m' = m + \mu$,
$\sin\alpha' = (j'_{m,2}/j'_{m',1}) \, \sin\alpha$, and
$j'_{m,n}$ is the $n$-th zero of $J'_m(x)$.
The particular realization in Fig.~\ref{fig:tractorbeams}(c)
is a three-fold ($\mu = 3$) tractor-beam mode \cite{yevick16}
with $m = -10$ and $\alpha = \SI{6.4}{\milli\radian}$.
These parameters satisfy the condition
$\cos(\alpha) > [m/(m + \mu)] \cos(\alpha + \delta \alpha)$
required for a solenoidal wave to act as a tractor beam
\cite{yevick16}.
As with the conveyor beam, the intermediate-plane hologram
projecting the solenoidal tractor beam has a diffraction
efficiency of roughly \num{0.3}, and yields a non-diffracting
range exceeding \SI{1}{\meter}.

Solenoidal modes are examples of accelerating waves \cite{berry79}
in the sense that the position of the principal intensity maximum,
is a non-linear function of axial position.
Intermediate-plane holography therefore is useful for creating
non-diffracting accelerating modes with high diffraction efficiency.

The same approach used for these demonstrations also can be
applied to more complicated superpositions of Bessel modes
\cite{cizmar09,vasilyeu09,lee10,litvin11}. % XXX related citations.
In all cases, the intermediate-plane approach should provide
better mode purity, longer range and higher diffraction efficiency
than conventional holographic mode-conversion techniques.

In addition to projecting collimated modes, intermediate-plane
holograms can project waves that converge or diverge at
a specified rate.  This is achieved by deliberately mis-matching
the placement of the intermediate plane with the back focal
plane of the converging element.  For intermediate-plane holograms
with integrated converging phase profiles, this is achieved by
having the displacement, $z$, differ from the focal length $f$.
In that case, the resulting divergence angle is
$\gamma = \tan^{-1}(1 - z/f)$. % XXX check sign
Each superposed mode in such an element, furthermore, can have
a different divergence angle.

\section{Conclusion}

Intermediate-plane holography is particularly useful for projecting
modes whose ideal Fresnel holograms are dominated by large
amplitude variations, and so suffer from low diffraction efficiency.
In addition to improving diffraction efficiency, shifting the
hologram plane also can improve mode purity by moving the
length scale for phase variations into the spatial bandwidth of a
practical diffractive optical element.
Both of these considerations figure in the success of intermediate-plane
holograms for projecting Bessel beams and their superpositions.
Because Bessel beams are the natural basis for propagation-invariant
modes, intermediate-plane holography lends itself naturally
to long-range projection.
We have demonstrated meter-scale projection using centimeter-scale
optical elements.
These same elements have additional potential applications for
topologically multiplexing and demultiplexing non-diffracting modes
for optical communications \cite{gibson04,bozinovic13,willner15}.
The same ability to project sophisticated superpositions of
topological modes could have additional applications to remote
sensing and LIDAR \cite{cvijetic15}.
Finally, the same principals discussed here in the context of
optical holography should apply equally well to other types
of waves, most notably to acoustic waves.


\section{Acknowledgment}
This work was supported primarily by the National Science Foundation
through Award no.\ DMR-1305875 and in part by NASA through
Award no.\ NNX13AK76G and through the NASA Space Technology Research
Fellowship (NSTRF) program under Award no.\ NNX15AQ40H.



